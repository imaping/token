# 1. 系统概述

### 1.1 系统简介

**imaping-token** 是一个企业级的 Token 管理和认证系统,提供统一的 Token 生命周期管理、多种存储后端支持和完整的 Spring Security 集成。系统设计遵循 SOLID 原则,采用模块化架构,支持单机和分布式部署场景。

**核心能力:**
- Token 生命周期管理 (创建、存储、检索、更新、删除)
- 灵活的过期策略 (自动续期、固定时间)
- 多存储后端 (内存、Redis)
- Spring Security 深度集成
- 分布式会话管理

### 1.2 系统边界

```
┌─────────────────────────────────────────────────────────────┐
│                     imaping-token 系统                       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  输入边界:                                                   │
│  ├─ HTTP 请求 (Header/Cookie/Param 中的 Token)              │
│  ├─ API 调用 (TokenRegistry 接口)                           │
│  └─ Spring Security 认证请求                                │
│                                                             │
│  输出边界:                                                   │
│  ├─ Token 验证结果                                          │
│  ├─ Authentication 对象                                     │
│  └─ SecurityContext 填充                                    │
│                                                             │
│  依赖边界:                                                   │
│  ├─ Spring Boot 3.5.6                                       │
│  ├─ Spring Security 6.x                                     │
│  ├─ Redis (可选)                                            │
│  └─ Servlet API 6.0                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 1.3 关键设计原则

**DRY (Don't Repeat Yourself):**
- 抽象基类封装通用逻辑 (AbstractToken, AbstractTokenRegistry)
- 配置统一管理 (IMapingConfigurationProperties)

**KISS (Keep It Simple):**
- 接口定义简洁明了 (Token, TokenRegistry)
- 默认实现开箱即用

**SOLID:**
- **单一职责**: 每个模块专注特定功能
- **开闭原则**: 通过接口和抽象类支持扩展
- **里氏替换**: Token 层次结构可替换
- **接口隔离**: 小而专一的接口设计
- **依赖倒置**: 依赖抽象而非具体实现

---
